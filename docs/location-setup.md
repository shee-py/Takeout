# 腾讯地图API配置说明

## 1. 申请腾讯地图API密钥

### 步骤1：注册腾讯地图开放平台账号
1. 访问 [腾讯地图开放平台](https://lbs.qq.com/)
2. 点击"控制台"进行注册/登录
3. 完成实名认证（个人或企业）

### 步骤2：创建应用
1. 在控制台中点击"应用管理" → "我的应用"
2. 点击"创建应用"
3. 填写应用信息：
   - 应用名称：你的小程序名称
   - 应用类型：选择"微信小程序"
   - 应用介绍：简单描述你的应用

### 步骤3：申请服务
1. 在应用详情页面，点击"添加Key"
2. 选择所需服务：
   - **逆地理编码**（必选）
   - WebServiceAPI（必选）
3. 设置调用量限制（个人开发者每天有免费额度）

### 步骤4：获取API密钥
1. 创建成功后，会生成一个API密钥（Key）
2. 复制这个密钥

## 2. 配置小程序

### 步骤1：更新API密钥
打开 [`config/api.js`](/config/api.js) 文件，将 `YOUR_TENCENT_MAP_KEY` 替换为你的实际密钥：

```javascript
const config = {
  TENCENT_MAP_KEY: '你的实际API密钥',
  // ... 其他配置
};
```

### 步骤2：配置服务器域名
在微信小程序后台（mp.weixin.qq.com）的"开发管理" → "开发设置" → "服务器域名"中添加：

**request合法域名**：
- `https://apis.map.qq.com`

### 步骤3：测试功能
1. 重新编译小程序
2. 点击定位按钮测试
3. 查看控制台日志确认API调用是否成功

## 3. 功能说明

### 地址解析优先级
1. **推荐地址**：腾讯地图推荐的最佳地址描述
2. **标准地址**：完整的地址信息
3. **组件地址**：省市区街道拼接
4. **POI信息**：附近100米内的兴趣点（如商场、学校等）

### 返回数据示例
```json
{
  "status": 0,
  "result": {
    "address": "广东省广州市天河区五山路483号",
    "formatted_addresses": {
      "recommend": "华南农业大学",
      "rough": "华南农业大学附近"
    },
    "address_component": {
      "province": "广东省",
      "city": "广州市",
      "district": "天河区",
      "street": "五山路",
      "street_number": "483号"
    },
    "pois": [
      {
        "title": "华南农业大学",
        "distance": 0
      }
    ]
  }
}
```

## 4. 注意事项

1. **免费额度**：个人开发者每天有一定的免费调用量
2. **域名配置**：确保在小程序后台配置了腾讯地图API域名
3. **错误处理**：代码中已包含错误处理，API调用失败时会显示"定位成功"
4. **隐私政策**：使用定位功能需要在小程序隐私政策中说明

## 5. 故障排除

### 常见问题
1. **API调用失败**：检查密钥是否正确、域名是否配置
2. **定位不准确**：检查手机GPS是否开启
3. **地址解析失败**：查看控制台错误信息，检查网络连接

### 调试方法
1. 在开发者工具中查看 Network 面板
2. 检查控制台日志中的"地址解析结果"
3. 确认API返回的status字段是否为0

## 6. 升级建议

如果需要更多功能，可以考虑：
1. 添加地址搜索功能
2. 集成地图显示
3. 添加路线规划
4. 实现周边商家搜索 